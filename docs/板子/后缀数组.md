# [后缀数组](https://www.matiji.net/exam/brushquestion/7/4347/179CE77A7B772D15A8C00DD8198AAC74)

```c++
#include <bits/stdc++.h>

const long long N = 1e6 + 100;

struct SA {
    long long log[N];
    long long st[22][N];
    long long a[N], x[N], y[N]; // 计数排序, x 低端，y 高端
    long long cnt[N], sa[N], rk[N];
    long long n;
    
    void init(std::string s) {
        n = (int)s.size() - 1;
        for (long long i = 2; i <= n; i ++) log[i] = log[i >> 1] + 1;
        for (long long i = 1; i < (int)s.size(); i ++) {
            a[i] = i; x[i] = y[i] = s[i];
        }
        cnt_sort(n);
        for (long long i = 1; i <= n; i ++) st[0][i] = rk[i];
        for (long long i = 1; i <= log[n]; i ++) build(i);
    }
    
    void cnt_sort(long long len) {
        long long mx = 0;
        for (long long i = 1; i <= len; i ++) cnt[x[a[i]]] ++, mx = std::max(mx, x[a[i]]);
        for (long long i = 1; i <= mx; i ++) cnt[i] += cnt[i - 1];
        for (long long i = len; i; i --) sa[cnt[x[a[i]]] --] = a[i];
        for (long long i = 1; i <= mx; i ++) cnt[i] = 0;
        mx = 0;
        for (long long i = 1; i <= len; i ++) a[i] = sa[i];
        for (long long i = 1; i <= len; i ++) cnt[y[a[i]]] ++, mx = std::max(mx, y[a[i]]);
        for (long long i = 1; i <= mx; i ++) cnt[i] += cnt[i - 1];
        for (long long i = len; i; i --) sa[cnt[y[a[i]]] --] = a[i];
        for (long long i = 1; i <= mx; i ++) cnt[i] = 0;
        for (long long i = 1; i <= len; i ++) {
            long long p = sa[i];
            long long q = sa[i - 1];
            if (x[p] == x[q] && y[p] == y[q]) rk[p] = rk[q];
            else rk[p] = rk[q] + 1;
        }
    }
    
    void build(long long k) {
        long long len = 0;
        for (long long i = 1; i + (1 << k) - 1 <= n; i ++) {
            a[i] = i;
            x[i] = st[k - 1][i + (1 << (k - 1)) - 1];
            y[i] = st[k - 1][i];
            len ++;            
        }
        cnt_sort(len);
        for (long long i = 1; i <= len; i ++) st[k][i] = rk[i];
    }
    
    // 从 i 开始，从 j 开始的长度为 k 的子串比较大小
    long long cmp(long long i, long long j, long long k) {
        if (k == 0) return 0;
        long long t = log[k];
        if (st[t][i] != st[t][j]) return st[t][i] - st[t][j];
        else return cmp(i + (1 << t), j + (1 << t), k - (1 << t));
    }
    
};

long long n, m;
std::string s;
long long a[N];
long long pre[N], post[N];
SA sa;
long long big[N];

void solve() {
    std::cin >> n >> m >> s;
    s = ' ' + s;
    sa.init(s);
    for (long long i = 1; i <= n; i ++) a[i] = s[i] - '0';
    for (long long i = 1; i <= n; i ++) pre[i] = pre[i - 1] + a[i];
    for (long long i = 1; i <= n; i ++) post[i] = post[i - 1] + a[n - i + 1];
    long long mx = 1;
    for (long long i = 1; i + n - m - 1 <= n; i ++) {
        // std::cout << sa.cmp(mx, i, n - m) << '\n';
        if (sa.cmp(mx, i, n - m) < 0) mx = i;
    }
    long long sum = pre[mx - 1] + post[m - mx + 1];
    for (long long i = mx + n - m - 1, j = 1; i >= mx; i --, j ++) {
        big[j] = a[i];
        // std::cout << big[j];
    } 
    // std::cout << '\n';
    long long len = n - m;
    // std::cout << sum << '\n';
    for (long long i = 1, t = sum; t != 0; i ++) {
        big[i] += t;
        t = big[i] / 10;
        big[i] %= 10;
        len = std::max(i, len);
    }
    for (long long i = len; i; i --) std::cout << big[i];
    std::cout << '\n';
}

/*
oj Rand.py Main.py Main.cpp 10
*/

int main() {
    std::ios::sync_with_stdio(0);
    std::cin.tie(0);
    std::cout.tie(0);
    
    solve();
    return 0;
}
```