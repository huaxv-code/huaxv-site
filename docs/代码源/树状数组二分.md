# [树状数组二分](http://oj.daimayuan.top/course/15/problem/636)

=== "树状数组 + 二分查找"

    ```c++
    #include <bits/stdc++.h>


    const long long N = 1e6;
    long long n, m;
    long long a[N];
    long long b[N];

    long long lowbit(long long x)
    {
        return x & -x;
    }

    void add(long long id, long long x)
    {
        while (id <= n)
        {
            b[id] += x;
            id += lowbit(id);
        }
    }

    long long sum(long long id)
    {
        long long ans = 0;
        while (id > 0)
        {
            ans += b[id];
            id -= lowbit(id);
        }
        return ans;
    }

    void modify(long long id, long long val)
    {
        long long t = val - (sum(id) - sum(id - 1));
        add(id, t);
    }

    long long find(long long x)
    {
        long long l = 1, r = n, mid;
        while (l < r)
        {
            mid = (l + r + 1) >> 1;
            if (sum(mid) <= x) l = mid;
            else r = mid - 1;
        }
        if (sum(l) <= x) return l;
        return 0;
    }


    void solve()
    {
        
        std::cin >> n >> m;
        for (long long i = 1; i <= n; i ++)
        {
            std::cin >> a[i];
        }
        for (long long i = 1; i <= n; i ++)
        {
            add(i, a[i]);
        }
        
        while (m --)
        {
            long long mo, x, y;
            std::cin >> mo >> x;
            if (mo == 1)
            {
                std::cin >> y;
                modify(x, y);
            }
            else 
                std::cout << find(x) << '\n';
        }
        
    }

    int main()
    {
        std::ios::sync_with_stdio(0);
        std::cin.tie(0); std::cout.tie(0);
        
        
        solve();
        return 0;
    }

    ```
